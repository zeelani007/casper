"use strict";var __decorate=this&&this.__decorate||function(e,t,n,r){var s,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var d=e.length-1;0<=d;d--)(s=e[d])&&(o=(i<3?s(o):3<i?s(t,n,o):s(t,n))||o);return 3<i&&o&&Object.defineProperty(t,n,o),o};exports.__esModule=!0;var core_1=require("@angular/core"),Rx_1=require("rxjs/Rx"),demo_db_1=require("./demo.db"),BackendService=function(){function e(e,t){this.http=e,this.location=t,this.baseUrl="",this.ds=Object.assign({},demo_db_1.default)||{},console.log(this.ds)}return e.prototype.getModel=function(e){return e.includes("?")&&e.includes("/")?e.indexOf("?")>e.indexOf("/")?e.substring(0,e.indexOf("/")):e.substring(0,e.indexOf("?")):e.includes("?")?e.substring(0,e.indexOf("?")):e.substring(0,e.indexOf("/"))},e.prototype.getId=function(e,t){return 0<(e=e.substr(t.length+1)).length&&(e.includes("?")?e.substring(0,e.indexOf("?")):e)},e.prototype.getExpand=function(e,t){return(e=e.substr(e.indexOf("?"))).includes("_expand")?e.includes("&")?e.substring("_expand=".length+1,e.indexOf("&")):e.substring("_expand=".length+1):void 0},e.prototype.getEmbed=function(e){return e.includes("?")?e.substring(e.indexOf("/"),e.indexOf("?")):e.substring(e.indexOf("/"))},e.prototype.getData=function(a){var f=this;return new Promise(function(e,t){var n,r,s,i=f.getModel(a),o=f.getId(a,i),d=isNaN(o)?void 0:parseInt(o),u=f.getExpand(a,i),c=u?"category"===u?"categories":u+"s":u;f.getEmbed(a);console.log(i),console.log(c),i in f.ds&&(d?(n=f.ds[i][f.ds[i].findIndex(function(e){return e.id===d})],c&&(r="categories"===c?"category":c.substr(0,c.length-1),s=n[r+"Id"],n[r]=f.ds[c][f.ds[c].findIndex(function(e){return e.id===s})])):n=f.ds[i].map(function(e){return c&&(r="categories"===c?"category":c.substr(0,c.length-1),s=e[r+"Id"],e[r]=f.ds[c][f.ds[c].findIndex(function(e){return e.id===s})]),e})),setTimeout(e,200,{data:n})})},e.prototype.getAll=function(e){return Rx_1.Observable.fromPromise(this.getData(e))},e.prototype.getByQuery=function(e){return Rx_1.Observable.fromPromise(this.getData(e))},e.prototype.getById=function(e){return Rx_1.Observable.fromPromise(this.getData(e))},e.prototype.create=function(r,s){return Rx_1.Observable.fromPromise(new Promise(function(e,t){var n=this.getModel(r);s.id=this.ds[n]+1,this.ds[n].push(s),setTimeout(e,200,{data:s})}))},e.prototype.update=function(s,i){return Rx_1.Observable.fromPromise(new Promise(function(e,t){var n=this.getModel(s),r=this.ds[n].findIndex(function(e){return e.id===i.id});this.ds[n][r]=Object.assign({},i),setTimeout(e,200,{data:i})}))},e.prototype.delete=function(s){return Rx_1.Observable.fromPromise(new Promise(function(e,t){var n=this.getModel(s),r=this.getId();r&&this.ds[n].splice(this.ds[n].findIndex(function(e){return e.id===r})),setTimeout(e,200,{status:200})}))},e.prototype.login=function(e,t){var i=this;return console.log(this.ds),Rx_1.Observable.fromPromise(new Promise(function(e,t){var n=i.ds.token,r=n.access_token,s=n.user;setTimeout(e,200,{access_token:r,user:s})}))},e=__decorate([core_1.Injectable()],e)}();exports.BackendService=BackendService;
//# sourceMappingURL=backend.service.min.js.map
